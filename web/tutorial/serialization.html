<html><body>
<table border="0" cellpadding="0" cellspacing="0" width="980" bgcolor="#f4f0e5">
<tr><td background="../images/bar.png"><br>
</td></tr><tr><td>
<a href="../docs.html">Back to the docs page</a><br>

<br>
<a href="new_learner.html">Previous</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="look_around.html">Next</a>







<h2>Serialization</h2>

<p>In order to write code that will serialize and deserialize your models, you will use the GTwtDoc and GTwtNode classes (see the <a href="../apidoc/html/index.html">API documentation</a>). These classes enable you to build a document object model (DOM) that can be serialized and deserialized.</p>

<p>Why not just serialize/deserialize your model directly? There are several advantages to using a DOM. Most significantly, it is very easy to build a DOM, and to use one. So, this reduces the burden on the developer. Another advantage is that you can serialize to a variety of formats. For example, the DOM can be saved as an XML file. Unfortunately, XML has several drawbacks. Most significantly, it is bloated and unnecessarily complex. (Yes, I know that the original point of XML was to be simple, but as tends to happen with standards designed in committees, it has become a hairy mess.) Fortunately, the DOM can also be serialized to simpler formats. I like to use the "twt" format. Like XML, it is text-based. Unlike XML, it is very compact, and it is almost trivial to fully-implement a parser. Anyway, the best thing about using a DOM is that you (the developer) don't need to worry about the underlying format right now. You can decide which format to use to serialize the DOM later. All you need to do right now is write a method that will convert your model to a twt DOM, and one that will convert the twt DOM to your model.</p>

<p>The twt DOM was designed to make serializing C++ objects easy. Each GTwtNode is a node in a tree. Each node can be thought of as an "object", a "list", or a "value". Objects have named children. Lists have enumerated children. Values are things like bools, ints, doubles, and strings.</p>

<p>For example, suppose you have a class like this,
<pre>
	class MyClass
	{
		string m_name;
		int m_age;
		double m_height;
		bool m_admin;
		vector&lt;string&gt; m_friends;
	};
</pre>
, and you would like to write a method that will convert it to a twt DOM. Here is how you would do it:
<pre>
	GTwtNode* MyClass::toTwt(GTwtDoc* pDoc)
	{
		GTwtNode* pNode = pDoc->newObj();
		pNode->addField(pDoc, "name", pDoc->newString(m_name.c_str()));
		pNode->addField(pDoc, "age", pDoc->newInt(m_age));
		pNode->addField(pDoc, "height", pDoc->newDouble(m_height));
		pNode->addField(pDoc, "admin", pDoc->newBool(m_admin));
		GTwtNode* pFriends = pNode->addField(pDoc, "friends", pDoc->newList(m_friends.size()));
		for(size_t i = 0; i &lt; m_friends.size(); i++)
			pFriends->setItem(i, pDoc->newString(m_friends[i].c_str()));
		return pNode;
	}
</pre>
This code will create a DOM with the following structure:<br>
<center><img src="dom.png"></center></p>

<p>Next, let's write some code that will construct your object using the DOM
<pre>
	void MyClass::MyClass(GTwtNode* pNode)
	{
		m_name = pNode->field("name")->asString();
		m_age = pNode->field("age")->asInt();
		m_height = pNode->field("height")->asDouble();
		m_admin = pNode->field("admin")->asBool();
		GTwtNode* pFriends = pNode->field("friends");
		for(size_t i = 0; i &lt; pFriends->itemCount(); i++)
			m_friends.push_back(pFriends->item(i)->asString());
	}
</pre>






<br>
<a href="new_learner.html">Previous</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="look_around.html">Next</a>

<br><br><a href="../docs.html">Back to the docs page</a>
</td></tr><tr><td background="../images/bar.png"><br>
</td></tr></table>
</body></html>